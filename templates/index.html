<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bill Splitter</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container" style="max-width: 1200px;">
        <h1><a href="/" style="text-decoration: none; color: inherit;">ðŸ’° Bill Splitter</a></h1>
        
        <div class="app-layout" style="display: flex; gap: 20px; align-items: flex-start; flex-wrap: wrap;">
            <!-- Sidebar for Participants -->
            <div class="sidebar" style="flex: 0 0 250px; min-width: 250px;">
                <div class="card">
                    <h2>Participants <span id="uniquePeopleCount" style="font-size: 0.8em; color: #666; font-weight: normal;">(0)</span></h2>
                    <div id="participantsList" class="participants-list"></div>
                </div>
                
                <div class="card">
                    <h2>Share</h2>
                    <button id="shareBtn" class="btn btn-primary" style="background: #805ad5;">Share Split</button>
                    <div id="shareLinks" style="display: none; margin-top: 15px;">
                        <div style="margin-bottom: 10px;">
                            <label style="font-size: 0.85em; font-weight: bold; color: #555;">View Only Link:</label>
                            <div class="input-group">
                                <input type="text" id="viewLink" readonly>
                                <button class="btn btn-copy" id="copyViewLink">Copy</button>
                            </div>
                        </div>
                        <div>
                            <label style="font-size: 0.85em; font-weight: bold; color: #555;">Edit Link:</label>
                            <div class="input-group">
                                <input type="text" id="editLink" readonly>
                                <button class="btn btn-copy" id="copyEditLink">Copy</button>
                            </div>
                            <div style="font-size: 0.75em; color: #e53e3e; margin-top: 2px;">Don't share this with everyone!</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="main-content" style="flex: 1; min-width: 300px;">
                <div class="card">
                    <h2>Add Expense</h2>
                    <form id="addPersonForm">
                <div class="form-group">
                    <label for="personName">Name:</label>
                    <input type="text" id="personName" required list="participantsDatalist" placeholder="Who paid?">
                    <datalist id="participantsDatalist"></datalist>
                </div>

                <div class="form-group">
                    <label for="description">Description (Optional):</label>
                    <input type="text" id="description" placeholder="e.g. Drinks, Taxi">
                </div>
                
                <div class="form-group">
                    <label for="amountSpent">Amount Spent:</label>
                    <input type="number" id="amountSpent" step="0.01" min="0" value="0" required>
                </div>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="isSponsor">
                        Is Sponsor
                    </label>
                </div>

                <div class="form-group" id="sponsorAmountGroup" style="display: none;">
                    <label for="sponsorAmount">Sponsor Amount:</label>
                    <input type="number" id="sponsorAmount" step="0.01" min="0" value="0">
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button type="submit" class="btn btn-primary" id="submitBtn">Add Person</button>
                    <button type="button" class="btn" id="cancelEditBtn" style="display: none; background: #718096; color: white;">Cancel</button>
                </div>
            </form>
        </div>

                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2 style="margin-bottom: 0;">Expenses</h2>
                        <button id="clearAllBtn" class="btn btn-danger" style="width: auto; padding: 8px 16px;">Clear All</button>
                    </div>
                    <div id="peopleList" class="people-list"></div>
                </div>

        <div class="card">
            <h2>Settings</h2>
            <div class="form-group checkbox-group">
                <label>
                    <input type="checkbox" id="includeSponsorInSplit" checked>
                    Include sponsors in equal split
                </label>
            </div>
            <div class="form-group checkbox-group">
                <label>
                    <input type="checkbox" id="restrictSponsorToSpent" checked>
                    Restrict sponsorship to total spent (prevent negative share)
                </label>
            </div>
            <button id="calculateBtn" class="btn btn-success">Calculate Split</button>
        </div>

            <div id="resultsSection" class="card results-section" style="display: none;">
                <h2>Results</h2>
                <div class="summary">
                    <p><strong>Total Spent:</strong> $<span id="totalSpent">0.00</span></p>
                    <p><strong>Total Sponsored:</strong> $<span id="totalSponsored">0.00</span></p>
                    <p><strong>Amount to Share:</strong> $<span id="amountToShare">0.00</span></p>
                    <p><strong>Number of Participants:</strong> <span id="numParticipants">0</span></p>
                    <p><strong>Per Person Share:</strong> $<span id="perPersonShare">0.00</span></p>
                </div>
                <h3>Settlements</h3>
                <div id="settlementsList" class="settlements-list"></div>
            </div>
        </div>

        <!-- Right Sidebar for History -->
        <div class="sidebar-right" style="flex: 0 0 250px; min-width: 250px;">
            <div class="card">
                <h2>History</h2>
                <p style="font-size: 0.8em; color: #666; margin-bottom: 10px;">Local archives of your sessions.</p>
                <button id="archiveBtn" class="btn btn-secondary" style="width: 100%; margin-bottom: 15px; background-color: #718096;">Archive Current</button>
                <div id="historyList" class="history-list" style="display: flex; flex-direction: column; gap: 10px;">
                    <!-- History items will appear here -->
                </div>
            </div>
        </div>
    </div>
</div>

    <script src="/static/script.js?v=1"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bill Splitter</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’°</text></svg>">
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container" style="max-width: 1200px;">
        <h1><a href="/" style="text-decoration: none; color: inherit;">ðŸ’° Bill Splitter</a></h1>
        
        <div class="app-layout" style="display: flex; gap: 20px; align-items: flex-start; flex-wrap: wrap;">
            <!-- Sidebar for Participants -->
            <div class="sidebar" style="flex: 0 0 250px; min-width: 250px;">
                <div class="card">
                    <h2>Participants <span id="uniquePeopleCount" style="font-size: 0.8em; color: #666; font-weight: normal;">(0)</span></h2>
                    <div id="participantsList" class="participants-list"></div>
                </div>
                
                <div class="card">
                    <h2>Share</h2>
                    <button id="shareBtn" class="btn btn-primary" style="background: #805ad5;">Share Split</button>
                    <div id="shareLinks" style="display: none; margin-top: 15px;">
                        <div style="margin-bottom: 10px;">
                            <label style="font-size: 0.85em; font-weight: bold; color: #555;">View Only Link:</label>
                            <div class="input-group">
                                <input type="text" id="viewLink" readonly>
                                <button class="btn btn-copy" id="copyViewLink">Copy</button>
                            </div>
                        </div>
                        <div>
                            <label style="font-size: 0.85em; font-weight: bold; color: #555;">Edit Link:</label>
                            <div class="input-group">
                                <input type="text" id="editLink" readonly>
                                <button class="btn btn-copy" id="copyEditLink">Copy</button>
                            </div>
                            <div style="font-size: 0.75em; color: #e53e3e; margin-top: 2px;">Don't share this with everyone!</div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h2>History</h2>
                    <p style="font-size: 0.8em; color: #666; margin-bottom: 10px;">Local archives of your sessions.</p>
                    <button id="archiveBtn" class="btn btn-secondary" style="width: 100%; margin-bottom: 15px; background-color: #718096;">Archive Current</button>
                    <div id="historyList" class="history-list" style="display: flex; flex-direction: column; gap: 10px;">
                        <!-- History items will appear here -->
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="main-content" style="flex: 1; min-width: 300px;">
                <div class="card">
                    <h2>Add Expense</h2>
                    <form id="addPersonForm">
                <div class="form-group">
                    <label for="personName">Name:</label>
                    <input type="text" id="personName" required placeholder="Who paid?" autocomplete="off">
                    <select id="participantSelect" style="display: none; width: 100%; margin-top: 8px; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px; background-color: white; cursor: pointer;">
                        <option value="">-- Select existing participant --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="description">Description (Optional):</label>
                    <input type="text" id="description" placeholder="e.g. Drinks, Taxi">
                </div>
                
                <div class="form-group">
                    <label for="amountSpent">Amount Spent:</label>
                    <input type="text" id="amountSpent" inputmode="decimal" placeholder="0.00" required>
                </div>

                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="hasExpenseTip">
                        Tip/Tax on spent
                    </label>
                </div>

                <div class="form-group" id="expenseTipGroup" style="display: none;">
                    <label for="expenseTipPercentage">Tip/Tax Percentage (%):</label>
                    <input type="text" id="expenseTipPercentage" inputmode="decimal" placeholder="10">
                </div>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="isSponsor">
                        Is Sponsor
                    </label>
                </div>

                <div class="form-group" id="sponsorAmountGroup" style="display: none;">
                    <label for="sponsorAmount">Sponsor Amount:</label>
                    <input type="text" id="sponsorAmount" inputmode="decimal" placeholder="0.00">
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button type="submit" class="btn btn-primary" id="submitBtn">Add Person</button>
                    <button type="button" class="btn" id="cancelEditBtn" style="display: none; background: #718096; color: white;">Cancel</button>
                </div>
            </form>
        </div>

                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h2 style="margin-bottom: 0;">Expenses <span id="expensesCount" style="font-size: 0.8em; color: #666; font-weight: normal;">(0)</span></h2>
                        <button id="clearAllBtn" class="btn btn-danger" style="width: auto; padding: 8px 16px;">Clear All</button>
                    </div>
                    <div style="background: #f7fafc; padding: 10px; border-radius: 6px; margin-bottom: 15px; font-size: 0.9em; color: #4a5568; display: flex; gap: 15px; flex-wrap: wrap;">
                        <span><strong>Total Spent:</strong> $<span id="expensesTotal">0.00</span></span>
                        <span style="color: #cbd5e0;">|</span>
                        <span><strong>Total Sponsor:</strong> $<span id="expensesSponsor">0.00</span></span>
                    </div>
                    <div id="peopleList" class="people-list"></div>
                </div>

        </div>

        <div class="sidebar-right" style="flex: 0 0 300px; min-width: 300px;">
            <div class="card">
                <h2>Settings</h2>
                <div class="form-group">
                    <label for="fundAmount">Fund / Discount Amount:</label>
                    <input type="text" id="fundAmount" inputmode="decimal" placeholder="0.00">
                    <small style="color: #666; display: block; margin-top: 4px;">Amount available to cover expenses before splitting (e.g. team budget)</small>
                </div>
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="includeSponsorInSplit" checked>
                        Include sponsors in equal split
                    </label>
                </div>
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="addTip">
                        Add Tip/Tax
                    </label>
                </div>
                <div class="form-group" id="tipAmountGroup" style="display: none;">
                    <label for="tipPercentage">Tip/Tax Percentage (%):</label>
                    <input type="number" id="tipPercentage" value="10" min="0" step="0.1">
                </div>
                <button id="calculateBtn" class="btn btn-success">Calculate Split</button>
            </div>

            <div id="resultsSection" class="card results-section" style="display: none;">
                <h2>Results</h2>
                <div class="summary">
                    <p><strong>Total Spent:</strong> $<span id="totalSpent">0.00</span></p>
                    <p id="tipRow" style="display: none;"><strong>Tip/Tax (<span id="tipPercentDisplay">0</span>%):</strong> $<span id="totalTip">0.00</span></p>
                    <p><strong>Total Sponsored:</strong> $<span id="totalSponsored">0.00</span></p>
                    <p id="fundRow" style="display: none;"><strong>Fund Used:</strong> $<span id="fundUsed">0.00</span></p>
                    <p><strong>Amount to Share:</strong> $<span id="amountToShare">0.00</span></p>
                    <p><strong>Number of Participants:</strong> <span id="numParticipants">0</span></p>
                    <p><strong>Per Person Share:</strong> $<span id="perPersonShare">0.00</span></p>
                </div>
                <h3>Settlements</h3>
                <div id="settlementsList" class="settlements-list"></div>
            </div>
        </div>
    </div>
</div>

    <script src="/static/script.js?v=1"></script>
</body>
</html>
